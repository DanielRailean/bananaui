import{s as ue,n as Q,d as m,i as p,v as P,w as Y,x as ke,y as N,z as Z,F as z,r as pe,l as b,H as O,b as y,q as B,I as j,e as E,J as A,a as J,f as T,t as V,K as we,g as K,c as F,j as G,h as U,o as Ee}from"../chunks/scheduler.BcKSNpAY.js";import{S as de,i as ce,d as S,t as L,a as D,c as ye,m as W,b as R,e as I,g as Me}from"../chunks/index.DxnxjsIE.js";import{s as $,k as ze,p as x}from"../chunks/config.D0o5BfjJ.js";import{C as Be,A as Ce}from"../chunks/ArrayWrap.B19lcAD0.js";import{g as he,i as ee,e as Le,a as De}from"../chunks/toastStore.DQsilM7O.js";import{t as H}from"../chunks/bundle-mjs.D696Ktp4.js";import{b as X,g as Pe}from"../chunks/entry.B3w4v2Qv.js";import{D as te,t as je}from"../chunks/stores.1n94Uydz.js";import{a as le}from"../chunks/requests.DSA7mczG.js";import{p as Ae}from"../chunks/stores.OrkqC-ye.js";import{c as ie,d as re}from"../chunks/util.UN72V8S8.js";import{B as se}from"../chunks/Button.Buwpr5CI.js";import{S as Se}from"../chunks/Spinner.D7KB-26a.js";function We(r){let e,s,i,l,t,a=r[4].id&&r[4].title&&ae(r),o=r[6].id&&r[6].desc&&ne(r),u=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},{color:r[2]},r[11],{class:l=H("shrink-0",r[9][r[0]??"md"],r[12].class)},{role:r[1]},{"aria-label":r[7]},{"aria-describedby":t=r[8]?r[10]:void 0},{viewBox:"0 0 24 24"}],f={};for(let n=0;n<u.length;n+=1)f=N(f,u[n]);return{c(){e=A("svg"),a&&a.c(),s=P(),o&&o.c(),i=A("path"),this.h()},l(n){e=j(n,"svg",{xmlns:!0,fill:!0,color:!0,class:!0,role:!0,"aria-label":!0,"aria-describedby":!0,viewBox:!0});var _=E(e);a&&a.l(_),s=P(),o&&o.l(_),i=j(_,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),E(i).forEach(m),_.forEach(m),this.h()},h(){b(i,"stroke","currentColor"),b(i,"stroke-linecap","round"),b(i,"stroke-linejoin","round"),b(i,"stroke-width",r[5]),b(i,"d","M17.651 7.65a7.131 7.131 0 0 0-12.68 3.15M18.001 4v4h-4m-7.652 8.35a7.13 7.13 0 0 0 12.68-3.15M6 20v-4h4"),O(e,f)},m(n,_){p(n,e,_),a&&a.m(e,null),y(e,s),o&&o.m(e,null),y(e,i)},p(n,_){n[4].id&&n[4].title?a?a.p(n,_):(a=ae(n),a.c(),a.m(e,s)):a&&(a.d(1),a=null),n[6].id&&n[6].desc?o?o.p(n,_):(o=ne(n),o.c(),o.m(e,i)):o&&(o.d(1),o=null),_&32&&b(i,"stroke-width",n[5]),O(e,f=he(u,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},_&4&&{color:n[2]},_&2048&&n[11],_&4097&&l!==(l=H("shrink-0",n[9][n[0]??"md"],n[12].class))&&{class:l},_&2&&{role:n[1]},_&128&&{"aria-label":n[7]},_&256&&t!==(t=n[8]?n[10]:void 0)&&{"aria-describedby":t},{viewBox:"0 0 24 24"}]))},d(n){n&&m(e),a&&a.d(),o&&o.d()}}}function Re(r){let e,s,i,l,t,a,o,u=r[4].id&&r[4].title&&oe(r),f=r[6].id&&r[6].desc&&fe(r),n=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},{color:r[2]},r[11],{class:l=H("shrink-0",r[9][r[0]??"md"],r[12].class)},{role:r[1]},{"aria-label":r[7]},{"aria-describedby":t=r[8]?r[10]:void 0},{viewBox:"0 0 24 24"}],_={};for(let d=0;d<n.length;d+=1)_=N(_,n[d]);return{c(){e=A("svg"),u&&u.c(),s=P(),f&&f.c(),i=A("path"),this.h()},l(d){e=j(d,"svg",{xmlns:!0,fill:!0,color:!0,class:!0,role:!0,"aria-label":!0,"aria-describedby":!0,viewBox:!0});var g=E(e);u&&u.l(g),s=P(),f&&f.l(g),i=j(g,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),E(i).forEach(m),g.forEach(m),this.h()},h(){b(i,"stroke","currentColor"),b(i,"stroke-linecap","round"),b(i,"stroke-linejoin","round"),b(i,"stroke-width",r[5]),b(i,"d","M17.651 7.65a7.131 7.131 0 0 0-12.68 3.15M18.001 4v4h-4m-7.652 8.35a7.13 7.13 0 0 0 12.68-3.15M6 20v-4h4"),O(e,_)},m(d,g){p(d,e,g),u&&u.m(e,null),y(e,s),f&&f.m(e,null),y(e,i),a||(o=[B(e,"click",r[13]),B(e,"keydown",r[14]),B(e,"keyup",r[15]),B(e,"focus",r[16]),B(e,"blur",r[17]),B(e,"mouseenter",r[18]),B(e,"mouseleave",r[19]),B(e,"mouseover",r[20]),B(e,"mouseout",r[21])],a=!0)},p(d,g){d[4].id&&d[4].title?u?u.p(d,g):(u=oe(d),u.c(),u.m(e,s)):u&&(u.d(1),u=null),d[6].id&&d[6].desc?f?f.p(d,g):(f=fe(d),f.c(),f.m(e,i)):f&&(f.d(1),f=null),g&32&&b(i,"stroke-width",d[5]),O(e,_=he(n,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"none"},g&4&&{color:d[2]},g&2048&&d[11],g&4097&&l!==(l=H("shrink-0",d[9][d[0]??"md"],d[12].class))&&{class:l},g&2&&{role:d[1]},g&128&&{"aria-label":d[7]},g&256&&t!==(t=d[8]?d[10]:void 0)&&{"aria-describedby":t},{viewBox:"0 0 24 24"}]))},d(d){d&&m(e),u&&u.d(),f&&f.d(),a=!1,pe(o)}}}function ae(r){let e,s=r[4].title+"",i,l;return{c(){e=A("title"),i=V(s),this.h()},l(t){e=j(t,"title",{id:!0});var a=E(e);i=T(a,s),a.forEach(m),this.h()},h(){b(e,"id",l=r[4].id)},m(t,a){p(t,e,a),y(e,i)},p(t,a){a&16&&s!==(s=t[4].title+"")&&J(i,s),a&16&&l!==(l=t[4].id)&&b(e,"id",l)},d(t){t&&m(e)}}}function ne(r){let e,s=r[6].desc+"",i,l;return{c(){e=A("desc"),i=V(s),this.h()},l(t){e=j(t,"desc",{id:!0});var a=E(e);i=T(a,s),a.forEach(m),this.h()},h(){b(e,"id",l=r[6].id)},m(t,a){p(t,e,a),y(e,i)},p(t,a){a&64&&s!==(s=t[6].desc+"")&&J(i,s),a&64&&l!==(l=t[6].id)&&b(e,"id",l)},d(t){t&&m(e)}}}function oe(r){let e,s=r[4].title+"",i,l;return{c(){e=A("title"),i=V(s),this.h()},l(t){e=j(t,"title",{id:!0});var a=E(e);i=T(a,s),a.forEach(m),this.h()},h(){b(e,"id",l=r[4].id)},m(t,a){p(t,e,a),y(e,i)},p(t,a){a&16&&s!==(s=t[4].title+"")&&J(i,s),a&16&&l!==(l=t[4].id)&&b(e,"id",l)},d(t){t&&m(e)}}}function fe(r){let e,s=r[6].desc+"",i,l;return{c(){e=A("desc"),i=V(s),this.h()},l(t){e=j(t,"desc",{id:!0});var a=E(e);i=T(a,s),a.forEach(m),this.h()},h(){b(e,"id",l=r[6].id)},m(t,a){p(t,e,a),y(e,i)},p(t,a){a&64&&s!==(s=t[6].desc+"")&&J(i,s),a&64&&l!==(l=t[6].id)&&b(e,"id",l)},d(t){t&&m(e)}}}function Ie(r){let e;function s(t,a){return t[3]?Re:We}let i=s(r),l=i(r);return{c(){l.c(),e=P()},l(t){l.l(t),e=P()},m(t,a){l.m(t,a),p(t,e,a)},p(t,[a]){i===(i=s(t))&&l?l.p(t,a):(l.d(1),l=i(t),l&&(l.c(),l.m(e.parentNode,e)))},i:Q,o:Q,d(t){t&&m(e),l.d(t)}}}function Te(r,e,s){const i=["size","role","color","withEvents","title","strokeWidth","desc","ariaLabel"];let l=Y(e,i);const t=ke("iconCtx")??{},a={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{size:o=t.size||"md"}=e,{role:u=t.role||"img"}=e,{color:f=t.color||"currentColor"}=e,{withEvents:n=t.withEvents||!1}=e,{title:_={}}=e,{strokeWidth:d=t.strokeWidth||"2"}=e,{desc:g={}}=e,w=`${_.id||""} ${g.id||""}`,C=!1,{ariaLabel:c="refresh outline"}=e;function k(h){z.call(this,r,h)}function v(h){z.call(this,r,h)}function M(h){z.call(this,r,h)}function q(h){z.call(this,r,h)}function _e(h){z.call(this,r,h)}function me(h){z.call(this,r,h)}function ge(h){z.call(this,r,h)}function be(h){z.call(this,r,h)}function ve(h){z.call(this,r,h)}return r.$$set=h=>{s(12,e=N(N({},e),Z(h))),s(11,l=Y(e,i)),"size"in h&&s(0,o=h.size),"role"in h&&s(1,u=h.role),"color"in h&&s(2,f=h.color),"withEvents"in h&&s(3,n=h.withEvents),"title"in h&&s(4,_=h.title),"strokeWidth"in h&&s(5,d=h.strokeWidth),"desc"in h&&s(6,g=h.desc),"ariaLabel"in h&&s(7,c=h.ariaLabel)},r.$$.update=()=>{r.$$.dirty&80&&(_.id||g.id?s(8,C=!0):s(8,C=!1))},e=Z(e),[o,u,f,n,_,d,g,c,C,a,w,l,e,k,v,M,q,_e,me,ge,be,ve]}class Ve extends de{constructor(e){super(),ce(this,e,Te,Ie,ue,{size:0,role:1,color:2,withEvents:3,title:4,strokeWidth:5,desc:6,ariaLabel:7})}}function qe(r){let e,s,i;return e=new Ve({props:{class:"mr-2"}}),{c(){I(e.$$.fragment),s=V(`
			Refresh`)},l(l){R(e.$$.fragment,l),s=T(l,`
			Refresh`)},m(l,t){W(e,l,t),p(l,s,t),i=!0},p:Q,i(l){i||(D(e.$$.fragment,l),i=!0)},o(l){L(e.$$.fragment,l),i=!1},d(l){l&&m(s),S(e,l)}}}function Fe(r){let e,s,i,l,t,a;return i=new Be({props:{class:"mr-2"}}),{c(){e=U("a"),s=U("div"),I(i.$$.fragment),l=V(`
					Add`),this.h()},l(o){e=F(o,"A",{href:!0});var u=E(e);s=F(u,"DIV",{class:!0});var f=E(s);R(i.$$.fragment,f),l=T(f,`
					Add`),f.forEach(m),u.forEach(m),this.h()},h(){b(s,"class","flex flex-row items-center space-x-1"),b(e,"href",t=X+"/add?type="+r[1])},m(o,u){p(o,e,u),y(e,s),W(i,s,null),y(s,l),a=!0},p(o,u){(!a||u&2&&t!==(t=X+"/add?type="+o[1]))&&b(e,"href",t)},i(o){a||(D(i.$$.fragment,o),a=!0)},o(o){L(i.$$.fragment,o),a=!1},d(o){o&&m(e),S(i)}}}function Ue(r){let e,s,i;return s=new Se({props:{text:"Loading "+(r[1]??"")}}),{c(){e=U("div"),I(s.$$.fragment),this.h()},l(l){e=F(l,"DIV",{class:!0});var t=E(e);R(s.$$.fragment,t),t.forEach(m),this.h()},h(){b(e,"class","flex flex-row items-center pl-5 pb-4")},m(l,t){p(l,e,t),W(s,e,null),i=!0},p(l,t){const a={};t&2&&(a.text="Loading "+(l[1]??"")),s.$set(a)},i(l){i||(D(s.$$.fragment,l),i=!0)},o(l){L(s.$$.fragment,l),i=!1},d(l){l&&m(e),S(s)}}}function Ne(r){let e,s;return e=new Ce({props:{dataRaw:r[0],type:r[1],entity:r[2]}}),e.$on("refresh",r[6]),{c(){I(e.$$.fragment)},l(i){R(e.$$.fragment,i)},m(i,l){W(e,i,l),s=!0},p(i,l){const t={};l&1&&(t.dataRaw=i[0]),l&2&&(t.type=i[1]),l&4&&(t.entity=i[2]),e.$set(t)},i(i){s||(D(e.$$.fragment,i),s=!0)},o(i){L(e.$$.fragment,i),s=!1},d(i){S(e,i)}}}function Oe(r){let e,s,i,l,t,a,o,u,f,n,_,d;document.title=e=ie(r[1])+" "+(r[1]?"|":"")+" "+$.name,t=new se({props:{class:" flex flex-row mr-2  items-center bg-green-500 dark:bg-green-700",$$slots:{default:[qe]},$$scope:{ctx:r}}}),t.$on("click",r[4]),o=new se({props:{class:"flex flex-row mr-2 bg-blue-500 dark:bg-blue-600",$$slots:{default:[Fe]},$$scope:{ctx:r}}}),o.$on("click",r[5]);const g=[Ne,Ue],w=[];function C(c,k){return c[0]?0:1}return f=C(r),n=w[f]=g[f](r),{c(){s=G(),i=U("div"),l=U("div"),I(t.$$.fragment),a=G(),I(o.$$.fragment),u=G(),n.c(),_=P(),this.h()},l(c){we("svelte-c4jj3",document.head).forEach(m),s=K(c),i=F(c,"DIV",{class:!0});var v=E(i);l=F(v,"DIV",{class:!0});var M=E(l);R(t.$$.fragment,M),a=K(M),R(o.$$.fragment,M),M.forEach(m),v.forEach(m),u=K(c),n.l(c),_=P(),this.h()},h(){b(l,"class","flex flex-row mb-2 h-10"),b(i,"class","flex flex-col m-4 mb-3 font-light text-2xl")},m(c,k){p(c,s,k),p(c,i,k),y(i,l),W(t,l,null),y(l,a),W(o,l,null),p(c,u,k),w[f].m(c,k),p(c,_,k),d=!0},p(c,[k]){(!d||k&2)&&e!==(e=ie(c[1])+" "+(c[1]?"|":"")+" "+$.name)&&(document.title=e);const v={};k&1024&&(v.$$scope={dirty:k,ctx:c}),t.$set(v);const M={};k&1026&&(M.$$scope={dirty:k,ctx:c}),o.$set(M);let q=f;f=C(c),f===q?w[f].p(c,k):(Me(),L(w[q],1,1,()=>{w[q]=null}),ye(),n=w[f],n?n.p(c,k):(n=w[f]=g[f](c),n.c()),D(n,1),n.m(_.parentNode,_))},i(c){d||(D(t.$$.fragment,c),D(o.$$.fragment,c),D(n),d=!0)},o(c){L(t.$$.fragment,c),L(o.$$.fragment,c),L(n),d=!1},d(c){c&&(m(s),m(i),m(u),m(_)),S(t),S(o),w[f].d(c)}}}function He(r,e,s){let i,l,t,a=!1,o="";Ae.subscribe(g=>{f()}),Ee(()=>{a=!0,f()});let u;async function f(g=!1){if(!a)return;const w=new URLSearchParams(window.location.search);u=te.now();const C=l;s(1,l=w.get("type")??"none"),o=w.get("prefix")??"";let c=!1;C!=l&&(s(0,i=void 0),c=!0);try{if(s(2,t=ze.find(M=>M.name==l)),!t)return;let v=await(await le()).findAll(t.apiPath,{},o);if(!v.ok){Le(`failed to fetch the ${l}. ${v.err} (${v.code})`);return}s(0,i=v.data.data);var k=u;for(await re(x);v.data.next&&(v=await(await le()).request(v.data.next??"",void 0,void 0),k==u);)v.ok&&s(0,i=i.concat(v.data.data)),await re(x);je.set(l+te.now().toMillis()),g&&ee("refresh finished!")}catch(v){console.log(v),De({message:`Failed fetching the ${l}. ${v.message?v.message:""}`})}}return[i,l,t,f,()=>{f(!0),ee("refresh started!")},()=>{Pe(`${X}/add?type=${l}`)},async()=>await f()]}class rt extends de{constructor(e){super(),ce(this,e,He,Oe,ue,{})}}export{rt as component};
