var O=Object.defineProperty;var H=(s,e,i)=>e in s?O(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i;var E=(s,e,i)=>(H(s,typeof e!="symbol"?e+"":e,i),i);import{s as J,n as S,d as p,l as f,i as R,b as u,q as M,c as g,e as _,g as T,h as k,j as C,L as U,o as V,a as z,f as B,t as G,M as W,N as $}from"./scheduler.D5A9P7uc.js";import{S as F,i as N}from"./index.CAvwUErb.js";import{w as K}from"./index.DfclyTkQ.js";import{g as A,b as L}from"./entry.CH2Y4Owa.js";import{u as x,D as Q,c as X}from"./stores.DHrNY3bq.js";import{d as q,a as Y}from"./util.CjnGZA31.js";import{a as Z}from"./config.mEDQR0sl.js";function D(s){let e,i;return{c(){e=k("span"),i=G(s[2]),this.h()},l(t){e=g(t,"SPAN",{class:!0});var a=_(e);i=B(a,s[2]),a.forEach(p),this.h()},h(){f(e,"class","text-sm font-medium text-gray-900 dark:text-gray-300 mr-2")},m(t,a){R(t,e,a),u(e,i)},p(t,a){a&4&&z(i,t[2])},d(t){t&&p(e)}}}function I(s){let e,i;return{c(){e=k("span"),i=G(s[3]),this.h()},l(t){e=g(t,"SPAN",{class:!0});var a=_(e);i=B(a,s[3]),a.forEach(p),this.h()},h(){f(e,"class","ml-2 text-sm font-medium text-gray-900 dark:text-gray-300 mr-2")},m(t,a){R(t,e,a),u(e,i)},p(t,a){a&8&&z(i,t[3])},d(t){t&&p(e)}}}function ee(s){let e,i,t,a,d,m,h,b,v,n=s[2]&&D(s),l=s[3]&&I(s);return{c(){e=k("div"),n&&n.c(),i=C(),t=k("label"),a=k("input"),d=C(),m=k("div"),h=C(),l&&l.c(),this.h()},l(r){e=g(r,"DIV",{class:!0});var o=_(e);n&&n.l(o),i=T(o),t=g(o,"LABEL",{class:!0,title:!0});var y=_(t);a=g(y,"INPUT",{type:!0,class:!0}),d=T(y),m=g(y,"DIV",{class:!0}),_(m).forEach(p),y.forEach(p),h=T(o),l&&l.l(o),o.forEach(p),this.h()},h(){f(a,"type","checkbox"),a.checked=s[4],f(a,"class","sr-only peer"),f(m,"class","relative w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:dark:bg-stone-900 after:dark:border-none after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-800"),f(t,"class","inline-flex items-center cursor-pointer"),f(t,"title",s[1]),f(e,"class","flex flex-row items-center")},m(r,o){R(r,e,o),n&&n.m(e,null),u(e,i),u(e,t),u(t,a),u(t,d),u(t,m),u(e,h),l&&l.m(e,null),b||(v=M(a,"change",s[5]),b=!0)},p(r,[o]){r[2]?n?n.p(r,o):(n=D(r),n.c(),n.m(e,i)):n&&(n.d(1),n=null),o&16&&(a.checked=r[4]),o&2&&f(t,"title",r[1]),r[3]?l?l.p(r,o):(l=I(r),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:S,o:S,d(r){r&&p(e),n&&n.d(),l&&l.d(),b=!1,v()}}}function te(s,e,i){let t,a=S,d=()=>(a(),a=W(h,r=>i(4,t=r)),h);s.$$.on_destroy.push(()=>a());const m=r=>{l("change",r)};let{isChecked:h=K(!1)}=e;d();let{title:b=void 0}=e,{labelLeft:v=void 0}=e,{labelRight:n=void 0}=e;const l=U();return V(()=>{}),s.$$set=r=>{"isChecked"in r&&d(i(0,h=r.isChecked)),"title"in r&&i(1,b=r.title),"labelLeft"in r&&i(2,v=r.labelLeft),"labelRight"in r&&i(3,n=r.labelRight)},[h,b,v,n,t,m]}class he extends F{constructor(e){super(),N(this,e,te,ee,J,{isChecked:0,title:1,labelLeft:2,labelRight:3})}}function ie(s,e="GET",i,t){t||(t={}),i&&(t["content-type"]="application/json");const a={method:e,headers:t,body:JSON.stringify(i)};return fetch(s,a)}async function c(s,e="GET",i,t){const a=await ie(s,e,i,t),d={ok:a.ok,code:a.status};if(a.ok)try{d.data=await a.json()}catch{}else{d.err=await a.text();try{d.errTyped=JSON.parse(d.err)}catch{}}return d}class ae{constructor(e,i,t){E(this,"endpoint");E(this,"headers");this.endpoint=e,this.headers={...t},i&&(this.headers.authorization=`Bearer ${i}`)}getInfo(){return c(this.endpoint,void 0,void 0,this.headers)}request(e,i="GET",t,a=this.headers){return c(`${this.endpoint}${e.startsWith("/")?e:`/${e}`}`,i,t,{...this.headers,...a})}schema(e){return c(`${this.endpoint}/schemas/${e}`,void 0,void 0,this.headers)}pluginConfig(e){return c(`${this.endpoint}/schemas/plugins/${e}`,void 0,void 0,this.headers)}async findAll(e,i={},t=""){return c(`${this.endpoint}${t}/${e}?size=${Z}&sort_by=updated_at`,void 0,void 0,this.headers)}findRecord(e,i,t=""){return c(`${this.endpoint}${t}/${e}/${i}`,void 0,void 0,this.headers)}createRecord(e,i,t=""){return c(`${this.endpoint}${t}/${e}`,"POST",i,this.headers)}updateRecord(e,i,t,a=""){return c(`${this.endpoint}${a}/${e}/${i}`,"PATCH",t,this.headers)}deleteRecord(e,i,t=""){return c(`${this.endpoint}${t}/${e}/${i}`,"DELETE",void 0,this.headers)}}let w;const P=3;let j=async s=>{var t,a;s&&s>P&&Y({message:`Failed to return apiService after ${P} retries`});const e=$(x);if(e&&Q.now().toUnixInteger()>e.expires&&(x.set(void 0),A(`${L}/login?auto=true`)),w)return w;const i=(t=$(X))==null?void 0:t.config;return i?!e&&((a=i.oidc)!=null&&a.enabled)?(A(`${L}/login`),await q(200),await j(s?s+1:0)):(w=new ae(i.kongApi.endpoint,e==null?void 0:e.token,i.kongApi.requestHeaders),w):(await q(200),await j(s?s+1:0))};export{he as T,j as a};
